echo "ğŸš€ Running pre-push checks..."

# Get the current branch name
BRANCH=$(git rev-parse --abbrev-ref HEAD)

# Skip checks for main and staging (CI/CD handles these)
if [ "$BRANCH" = "main" ] || [ "$BRANCH" = "staging" ]; then
  echo "â­ï¸  Skipping pre-push checks for $BRANCH branch (CI/CD will handle)"
  exit 0
fi

echo "ğŸ“‹ Running QA checks before push..."
echo ""

# Run format check
echo "ğŸ¨ Checking code formatting..."
if ! npm run format:check; then
  echo "âŒ Format check failed! Run 'npm run format' to fix."
  exit 1
fi

# Run lint check
echo "ğŸ” Checking code quality..."
if ! npm run lint; then
  echo "âŒ Lint check failed! Run 'npm run lint:fix' to fix."
  exit 1
fi

# Run type check
echo "ğŸ“ Checking types..."
if ! npm run type-check; then
  echo "âŒ Type check failed! Fix TypeScript errors before pushing."
  exit 1
fi

# Run tests
echo "ğŸ§ª Running tests..."
if ! npm run test:coverage; then
  echo "âŒ Tests failed! Fix failing tests before pushing."
  exit 1
fi

echo ""
echo "âœ… All pre-push checks passed!"
echo ""

